<div class="navbar navbar-fixed-bottom" tal:define="
    db python:context.getParentDatabase();
    dbUrl python:context.getParentDatabase().absolute_url();
    dbscript python:db.resources.application.script;
    transitionUrl python:dbscript.doTransition.absolute_url();
    createDocUrl python:dbscript.createDoc.absolute_url();
    pd python:context.REQUEST.PARENTS[0];
    pid python: pd.getId();
    user python:db.getCurrentUser().id;">  
        <input type="hidden" id="appUrl" tal:attributes="value string:${dbUrl}"/>    
    <div class="navbar-inner" style="padding-bottom:20px;">
        
        
        
        <!-- Toolbar della pagina iniziale --> 
        <tal:cond1 tal:condition="python:test(pid!='frm_cruscotto',False,True)">
            <ul class="nav pull-left" >
    <!--Nuova Istanza -->              
              <li class="dropdown" data-dropdown="dropdown">
                  <a href="#"  class="dropdown-toggle"><i class="icon-plus icon-white" style="margin-right:5px;"></i><span style="font-weight:bold;color:white;">Nuova Richiesta</span><b class="caret"></b></a>
                  <ul class="dropdown-menu no-circle" id="addnew">
                      <li class="no-circle"><a data-action="addnew" tal:attributes="href string:${dbUrl}/frm_cantiere/OpenForm;">Occupazione suolo per cantieri</a></li>
                      <li class="no-circle"><a data-action="addnew" tal:attributes="href string:${dbUrl}/frm_disabili/OpenForm;">Contrassegno disabili</a></li>
                      <li class="no-circle"><a data-action="addnew" tal:attributes="href string:${dbUrl}/frm_trasporti/OpenForm;">Autorizzazione al transito di convoglio eccezionale</a></li>
                  </ul>
              </li>
            
            </ul>
            <ul class="nav">
                <li>

                    <div class="btn-group">
                        <button id="btn-istanza" class="btn btn-small frm_all btn-inverse" data-type="action"><i class="icon-search icon-white" style="margin-right:5px;"></i><span style="font-weight:bold;color:white;">Vai alla pratica</span></button>
                        <button id="btn-rinnovo" class="btn btn-small frm_cantiere btn-inverse" data-type="action" data-form="frm_cantiere_rinnovo"><i class="icon-plus icon-white" style="margin-right:5px;"></i><span style="font-weight:bold;color:white;">Rinnovo</span></button>
                        <button id="btn-preavviso" class="btn btn-small frm_trasporti btn-inverse" data-type="action" data-form="frm_trasporti_preavvisi"><i class="icon-plus icon-white" style="margin-right:5px;"></i><span style="font-weight:bold;color:white;">Preavviso</span></button>
                    </div>
                </li>
            </ul>
        </tal:cond1> 
        
        
        
        <tal:cond2 tal:condition="python:test(pid=='frm_cruscotto',False,True)" tal:define="
            trList python: dbscript.getTransitions(pd);
            docList python: dbscript.elencoDocumenti(pd);
            state python: dbscript.getStatoIstanza(pd);
            mode python: test(pd.isEditMode(),test(pd.isNewDocument(),'new','edit'),'view');
            roles python:dbscript.getRoles();
">
    
    
    
<!-- Pulsantiera -->        
            <ul class="nav">
                <li><a tal:attributes="href string:${dbUrl}" id="homeButton"><i class="icon-home icon-white" style="margin-right:5px;"></i><span style="font-weight:bold;color:white;" >Pagina Iniziale</span></a></li>
                <li tal:condition="python:test(mode=='view',True,False)"><a  href="#" id="editButton"><i class="icon-pencil icon-white" style="margin-right:5px;"></i><span style="font-weight:bold;color:white;">Modifica</span></a></li>
                <li tal:condition="python:test(mode=='view',True,False)"><a href="#" id="deleteButton"><i class="icon-trash icon-white" style="margin-right:5px;"></i><span style="font-weight:bold;color:white;">Elimina</span></a></li>
                <li tal:condition="python:test(mode=='view',False,False)"><a href="#" id="checkButton"><i class="icon-thumbs-up icon-white" style="margin-right:5px;"></i><span style="font-weight:bold;color:white;">Verifica Pratica</span></a></li>
                <li tal:condition="python:test(mode=='view',False,True)"><a href="#" id="cancelButton"><i class="icon-step-backward icon-white" style="margin-right:5px;"></i><span style="font-weight:bold;color:white;">Annulla</span></a></li>
                <li tal:condition="python:test(mode=='view',False,True)"><a href="#" id="saveButton"><i class="icon-hdd icon-white" style="margin-right:5px;"></i><span style="font-weight:bold;color:white;">Salva</span></a></li>
            </ul>
            <ul tal:condition="python: pd.isDocument() and pd.getForm() == 'frm_trasporti'" class="nav">
                <li><a  style="margin-right:5px;" tal:attributes="href python:'%s/frm_trasporti_preavvisi/OpenForm?parentDocument=%s' % (db.absolute_url(), pd.getId())"><span style="font-weight:bold;color:white;">Nuovo preavviso</span></a></li>
            </ul>
          
            <ul tal:condition="python:test(mode=='view',True,False)" class="nav pull-right" >
    <!-- Generazione Documenti -->              
              <li class="dropdown" data-dropdown="dropdown">
                  <a id="printButton" href="#"  class="dropdown-toggle "><i class="icon-print icon-white" style="margin-right:5px;"></i><span style="font-weight:bold;color:white;">Crea Documento</span><b class="caret"></b></a>
                  <ul class="dropdown-menu no-circle" id="print-model">
                      <tal:loop tal:repeat="doc docList">
                          <li class="no-circle"><a data-action="print" tal:attributes="data-action string:createDoc;data-id string:${pid}; data-url string:${createDocUrl};data-model python:doc['id']" tal:content="python:doc['title']"></a></li>
                      </tal:loop>
                  </ul>
              </li>
    <!-- Transizioni -->            
              <li class="dropdown" data-dropdown="dropdown">
                  <a href="#" class="dropdown-toggle"><i class="icon-wrench icon-white" style="margin-right:5px;"></i><span style="font-weight:bold;color:white;">Azioni</span><b class="caret"></b></a>
                  <ul class="dropdown-menu" id="transition-list">
                      <tal:loop tal:repeat="tr trList">
                          <li class="no-circle"><a data-action="transition" tal:attributes="data-id string:${pid}; data-url string:${transitionUrl}; data-transition python:tr['id']" tal:content="python:tr['title']"></a></li>
                      </tal:loop>
                  </ul>
              </li>
            </ul>

    </tal:cond2>  
    </div>
    
</div>